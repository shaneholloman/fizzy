<% @page_title = "Home" %>
<%= turbo_stream_from :activity_summaries %>

<% content_for :header do %>
  <nav class="header">
    <header class="center">
      <%= render "events/filter", filter: @filter %>
    </header>
  </nav>
<% end %>

<header class="events-header header margin-block-end">
  <div class="header__actions header__actions--start">
    <% if collection = @filter.single_collection || Current.user.collections.ordered_by_recently_accessed.first %>
      <%= button_to collection_cards_path(collection), method: :post, class: "btn btn--link btn--circle-mobile" do %>
        <%= icon_tag "add" %>
        <span>Add a card</span>
      <% end %>
    <% end %>
  </div>

  <h1 class="header__title overflow-ellipsis">
    <div class="overflow-ellipsis">
      <% if @filter.collections.any? %>
        <%= filter_selected_collections_label(@filter) %>
      <% else %>
        <%= Account.sole.name %> / Latest activity
        <% if @filter.creators.any? %>
          by <%= @filter.creators.each_with_object([]) { |creator, names| names << creator.familiar_name }.to_sentence %>
        <% end %>
      <% end %>
    </div>
    <% if @filter.creators.any? %>
      <%= link_to events_path(@filter.as_params.except(:creator_ids)), class: "btn btn--remove txt-xx-small margin-inline-start" do %>
        <%= icon_tag "close" %>
        <span class="for-screen-reader">Clear all</span>
      <% end %>
    <% end %>
  </h1>

  <div class="header__actions header__actions--end"></div>
</header>
<div class="events" id="activity">
  <%= render "events/day", day_timeline: @day_timeline %>
</div>
<%= event_next_page_link(@day_timeline.next_day) %>
